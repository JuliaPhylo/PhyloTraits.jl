<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Discrete trait simulation · PhyloTraits.jl</title><meta name="title" content="Discrete trait simulation · PhyloTraits.jl"/><meta property="og:title" content="Discrete trait simulation · PhyloTraits.jl"/><meta property="twitter:title" content="Discrete trait simulation · PhyloTraits.jl"/><meta name="description" content="Documentation for PhyloTraits.jl."/><meta property="og:description" content="Documentation for PhyloTraits.jl."/><meta property="twitter:description" content="Documentation for PhyloTraits.jl."/><meta property="og:url" content="https://JuliaPhylo.github.io/PhyloTraits.jl/man/simulate_discrete/"/><meta property="twitter:url" content="https://JuliaPhylo.github.io/PhyloTraits.jl/man/simulate_discrete/"/><link rel="canonical" href="https://JuliaPhylo.github.io/PhyloTraits.jl/man/simulate_discrete/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="PhyloTraits.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="PhyloTraits.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">PhyloTraits.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../phyloregression/">Continuous trait analysis</a></li><li><a class="tocitem" href="../simulate_continuous/">Continuous trait simulation</a></li><li><a class="tocitem" href="../fitDiscrete/">Discrete trait analysis</a></li><li><a class="tocitem" href="../fitdiscreteDNA/">DNA evolutionary models</a></li><li class="is-active"><a class="tocitem" href>Discrete trait simulation</a><ul class="internal"><li><a class="tocitem" href="#binary-trait-example"><span>binary trait example</span></a></li><li><a class="tocitem" href="#example-of-DNA-simulation"><span>example of DNA simulation</span></a></li></ul></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/public/">public</a></li><li><a class="tocitem" href="../../lib/internal/">internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Discrete trait simulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Discrete trait simulation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaPhylo/PhyloTraits.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaPhylo/PhyloTraits.jl/blob/main/docs/src/man/simulate_discrete.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Discrete-trait-simulation"><a class="docs-heading-anchor" href="#Discrete-trait-simulation">Discrete trait simulation</a><a id="Discrete-trait-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-trait-simulation" title="Permalink"></a></h1><p><a href="../../lib/public/#Base.rand"><code>rand</code></a> can simulate discrete traits along a known network.</p><h2 id="binary-trait-example"><a class="docs-heading-anchor" href="#binary-trait-example">binary trait example</a><a id="binary-trait-example-1"></a><a class="docs-heading-anchor-permalink" href="#binary-trait-example" title="Permalink"></a></h2><p>For example, we can define a binary trait model with states &quot;carnivory&quot; (state 1) and &quot;non-carnivory&quot; (state 2), then ask for a trait to be simulated along our network. We can ask for 3 independent simulations, giving us 3 traits then, arranged in 3 rows.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; m1 = BinaryTraitSubstitutionModel(1.0,2.0, [&quot;carnivory&quot;, &quot;non-carnivory&quot;])</code><code class="nohighlight hljs ansi" style="display:block;">Binary Trait Substitution Model:
rate carnivory→non-carnivory α=1.0
rate non-carnivory→carnivory β=2.0</code></pre><p>We also need a phylogeny. We re-use the network from the section on <a href="../fitDiscrete/#Discrete-trait-evolution">Discrete trait evolution</a>. We then simulate traits with a stable random number generator (RNG) for reproducibility, but recommend using the default RNG by simply removing the argument <code>rng</code> below.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; net = readnewick(&quot;(O:4,(A:3,((B:0.4)#H1:1.6::0.92,((#H1:0::0.08,C:0.4):0.6,(D:.2,E:.2):0.8):1):1):1);&quot;);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using StableRNGs; rng = StableRNG(123); # for reproducibility of this example</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; traitmatrix, nodecolumn = rand(rng, m1, net; ntraits=3);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; traitmatrix</code><code class="nohighlight hljs ansi" style="display:block;">3×13 Matrix{Int64}:
 2  1  2  1  2  2  1  1  1  1  1  2  1
 1  1  2  2  2  2  1  2  1  1  2  1  1
 2  1  1  2  2  2  2  1  1  1  1  2  1</code></pre><p>In this trait matrix, each column corresponds to a node, each row is a trait, and each entry gives the state of that trait for that node, as an index. To get the state labels:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; labs = getlabels(m1)</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{String}:
 &quot;carnivory&quot;
 &quot;non-carnivory&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; labs[traitmatrix]</code><code class="nohighlight hljs ansi" style="display:block;">3×13 Matrix{String}:
 &quot;non-carnivory&quot;  &quot;carnivory&quot;  …  &quot;non-carnivory&quot;  &quot;carnivory&quot;
 &quot;carnivory&quot;      &quot;carnivory&quot;     &quot;carnivory&quot;      &quot;carnivory&quot;
 &quot;non-carnivory&quot;  &quot;carnivory&quot;     &quot;non-carnivory&quot;  &quot;carnivory&quot;</code></pre><p>The <code>nodecolumn</code> vector says which node corresponds to which column in the trait matrix, and we can compare to the node numbers in the network. For example, the first column corresponds to node <code>-2</code>, which is the root. (The root is always in the first column: that&#39;s where the simulation starts.)</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; nodecolumn</code><code class="nohighlight hljs ansi" style="display:block;">13-element Vector{String}:
 &quot;-2&quot;
 &quot;-3&quot;
 &quot;-4&quot;
 &quot;-6&quot;
 &quot;-8&quot;
 &quot;E&quot;
 &quot;D&quot;
 &quot;-7&quot;
 &quot;C&quot;
 &quot;H1&quot;
 &quot;B&quot;
 &quot;A&quot;
 &quot;O&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; getroot(net)</code><code class="nohighlight hljs ansi" style="display:block;">PhyloNetworks.Node:
 number:-2
 attached to 2 edges, numbered: 1 13</code></pre><p>As another example, we can extract the data for species &quot;A&quot;. We first get the column number for &quot;A&quot; (column 12), then get A&#39;s data in that column.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; findfirst(isequal(&quot;A&quot;), nodecolumn) # 12</code><code class="nohighlight hljs ansi" style="display:block;">12</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nodecolumn[12]</code><code class="nohighlight hljs ansi" style="display:block;">&quot;A&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; traitmatrix[:,12] # data for species A, as category indices</code><code class="nohighlight hljs ansi" style="display:block;">3-element Vector{Int64}:
 2
 1
 2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; labs[traitmatrix[:,12]] # same data, as category names</code><code class="nohighlight hljs ansi" style="display:block;">3-element Vector{String}:
 &quot;non-carnivory&quot;
 &quot;carnivory&quot;
 &quot;non-carnivory&quot;</code></pre><h2 id="example-of-DNA-simulation"><a class="docs-heading-anchor" href="#example-of-DNA-simulation">example of DNA simulation</a><a id="example-of-DNA-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#example-of-DNA-simulation" title="Permalink"></a></h2><p>Below we simulate 4 sites of a DNA alignment, independent from an HKY model with transition/transversion ratio κ=0.5 and stationary base frequencies of 0.2 for A and T and 0.3 for C and G:</p><p>and </p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; m2 = HKY85([.5], [0.20, 0.30, 0.30, 0.20])</code><code class="nohighlight hljs ansi" style="display:block;">HKY85 Substitution Model base frequencies: [0.2, 0.3, 0.3, 0.2]
relative rate version with transition/tranversion ratio kappa = 0.5,
 scaled so that there is one substitution per unit time
rate matrix Q:
               A       C       G       T
       A       *  0.4839  0.2419  0.3226
       C  0.3226       *  0.4839  0.1613
       G  0.1613  0.4839       *  0.3226
       T  0.3226  0.2419  0.4839       *</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rng = StableRNG(36154); # again, for reproducibility</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; traitmatrix, nodecolumn = rand(rng, m2, net; ntraits=4);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; traitmatrix</code><code class="nohighlight hljs ansi" style="display:block;">4×13 Matrix{Int64}:
 2  2  2  4  3  4  2  4  4  4  4  2  2
 2  3  2  3  3  2  4  4  2  2  1  3  3
 1  2  4  1  3  4  3  2  2  4  1  2  4
 1  1  1  3  4  4  4  3  3  1  3  1  3</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; labs = getlabels(m2)</code><code class="nohighlight hljs ansi" style="display:block;">4-element Vector{BioSymbols.DNA}:
 DNA_A
 DNA_C
 DNA_G
 DNA_T</code></pre><p>To get the data at the tips only, and in a specific order, we can do this.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; taxa = tiplabels(net)</code><code class="nohighlight hljs ansi" style="display:block;">6-element Vector{String}:
 &quot;O&quot;
 &quot;A&quot;
 &quot;B&quot;
 &quot;C&quot;
 &quot;D&quot;
 &quot;E&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; taxoncol = indexin(taxa, nodecolumn) # column indices to get taxa in order</code><code class="nohighlight hljs ansi" style="display:block;">6-element Vector{Union{Nothing, Int64}}:
 13
 12
 11
  9
  7
  6</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; labs[traitmatrix[:,taxoncol]] # trait at the tips only, ordered as in &#39;taxa&#39;</code><code class="nohighlight hljs ansi" style="display:block;">4×6 Matrix{BioSymbols.DNA}:
 DNA_C  DNA_C  DNA_T  DNA_T  DNA_C  DNA_T
 DNA_G  DNA_G  DNA_A  DNA_C  DNA_T  DNA_C
 DNA_T  DNA_C  DNA_A  DNA_C  DNA_G  DNA_T
 DNA_G  DNA_A  DNA_G  DNA_G  DNA_T  DNA_T</code></pre><p>This type of DNA data is from the package <a href="https://biojulia.dev/BioSymbols.jl/stable/">BioSymbols</a>, for interoperability with packages from <a href="https://biojulia.dev">BioJulia</a>.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using BioSequences</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; d = Dict(taxa[i] =&gt; LongDNA{4}(labs[traitmatrix[:,taxoncol[i]]])
                for i in eachindex(taxa))</code><code class="nohighlight hljs ansi" style="display:block;">Dict{String, BioSequences.LongSequence{BioSequences.DNAAlphabet{4}}} with 6 entries:
  &quot;B&quot; =&gt; TAAG
  &quot;A&quot; =&gt; CGCA
  &quot;C&quot; =&gt; TCCG
  &quot;D&quot; =&gt; CTGT
  &quot;E&quot; =&gt; TCTT
  &quot;O&quot; =&gt; CGTG</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../fitdiscreteDNA/">« DNA evolutionary models</a><a class="docs-footer-nextpage" href="../../lib/public/">public »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 13 February 2025 08:59">Thursday 13 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
